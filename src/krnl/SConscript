# vim: syntax=python

Import('env', 'arch', 'buildtype', 'distreq')

sources = []

kernel = env.Clone()

if arch == 'x86':
	sources += [
		'./arch/x86/display.c',
		'./arch/x86/interrupts.c',
		'./arch/x86/port.c',
		'./arch/x86/shutdown.c',
	]
	kernel.Append(LINKFLAGS=['-T', 'src/krnl/arch/x86/link.ld'])

sources += [
	'./boot/loader.asm',
	'./init/init.c',
	'./core/ipl.c',
	'./core/shutdown.c',
	'./core/text.c',
]

distreq += ['src/krnl/krnl.exe']

kernel.Program('krnl', sources)
